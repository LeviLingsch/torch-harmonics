
Training sfno_sc3_layer4_e16_linskip_nomlp, single step
--------------------------------------------------------------------------------
Epoch 0 summary:
time taken: 12.275231838226318
accumulated training loss: 81.95112119615078
relative validation loss: 0.31453534960746765
--------------------------------------------------------------------------------
Epoch 1 summary:
time taken: 12.126070976257324
accumulated training loss: 11.135277807712555
relative validation loss: 0.17323286086320877
--------------------------------------------------------------------------------
Epoch 2 summary:
time taken: 12.363983631134033
accumulated training loss: 6.723696790635586
relative validation loss: 0.11403469741344452
--------------------------------------------------------------------------------
Epoch 3 summary:
time taken: 12.119812488555908
accumulated training loss: 4.605938658118248
relative validation loss: 0.08259492367506027
--------------------------------------------------------------------------------
Epoch 4 summary:
time taken: 12.357356309890747
accumulated training loss: 3.3846650682389736
relative validation loss: 0.061827000230550766
--------------------------------------------------------------------------------
Epoch 5 summary:
time taken: 12.103299379348755
accumulated training loss: 2.6450821422040462
relative validation loss: 0.049391478300094604
--------------------------------------------------------------------------------
Epoch 6 summary:
time taken: 12.116603136062622
accumulated training loss: 2.1464980747550726
relative validation loss: 0.04061011224985123
--------------------------------------------------------------------------------
Epoch 7 summary:
time taken: 12.352512121200562
accumulated training loss: 1.7894884962588549
relative validation loss: 0.03438294865190983
--------------------------------------------------------------------------------
Epoch 8 summary:
time taken: 12.093624591827393
accumulated training loss: 1.5409418046474457
relative validation loss: 0.029891731217503548
Traceback (most recent call last):
  File "/cluster/home/llingsch/torch-harmonics/examples/train_sfno.py", line 464, in <module>
    main(train=True, load_checkpoint=False, enable_amp=False, log_grads=0)
  File "/cluster/home/llingsch/torch-harmonics/examples/train_sfno.py", line 425, in main
    train_model(model, dataloader, optimizer, gscaler, scheduler, nepochs=10, loss_fn='l2', enable_amp=enable_amp, log_grads=log_grads)
  File "/cluster/home/llingsch/torch-harmonics/examples/train_sfno.py", line 268, in train_model
    for inp, tar in dataloader:
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 701, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 757, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/examples/sfno/utils/pde_dataset.py", line 109, in __getitem__
    inp, tar = self._get_sample()
               ^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/examples/sfno/utils/pde_dataset.py", line 85, in _get_sample
    tar = self.solver.timestep(inp, self.nsteps)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/examples/shallow_water_equations.py", line 295, in timestep
    dudtspec[inew] = self.dudtspec(uspec)
                     ^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/examples/shallow_water_equations.py", line 171, in dudtspec
    ugrid = self.spec2grid(uspec)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/examples/shallow_water_equations.py", line 125, in spec2grid
    return self.isht(uspec)
           ^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cluster/home/llingsch/.local/lib/python3.11/site-packages/torch_harmonics/sht.py", line 198, in forward
    xs = torch.stack((rl, im), -1)
         ^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt